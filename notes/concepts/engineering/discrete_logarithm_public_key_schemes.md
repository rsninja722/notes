# discrete logarithm public key schemes

## diffie-hellman key exchange

used in SSH, TLS, IPSec

### set up

1. choose a large prime $p$
2. choose $\alpha \in \\{2,3,...,p-2\\}$
3. publish $p,a$

### exchange

- alice computes $k_A = {\alpha}^a \text{ mod } p$, sends to bob
- bob chooses $b \in \\{2,3,...,p-2\\}$
- bob computes $k_B = {\alpha}^b \text{ mod } p$, sends to alice
- alice computes $k_{AB} = k_B^a \text{ mod } p$
- bob computes $k_{AB} = k_A^b \text{ mod } p$

shared key is $k_AB$

### diffie-hellman problem (DHP)

let G be a finite cyclic group and let $\alpha \in G$ be a generator. given ${\alpha}^a$ and ${\alpha}^b$ for some unknown integers $a,b$, compute ${\alpha}^{ab}$

- if an attacker can solve DLP, they can solve DHP

## groups

set of elements with a binary operation $\cdot$ that satisfies:

1. closure: for every $a,b \in G$, $a \cdot b \in G$
2. associativity: for every $a,b,c \in G$, $(a \cdot b) \cdot c = a \cdot (b \cdot c)$
3. neutral element: there exists $e \in G$ such that $a \cdot e = e \cdot a = a$ for all $a \in G$
4. for every $a \in G$, there exists an element $b \in G$ such that $a \cdot b = b \cdot a = e$; $b$ is called the
inverse of $a$ and is denoted by $a^{−1}$.

- **abelian** - for all $a,b \in G, a \cdot b = b \cdot a$

- **coprime groups** - $\mathbb{Z}_{n}^{\times}$ - the set of all integers $< n$ coprime to n
    - abelian under multiplication mod n, identity element is 1

### cyclic groups

- **order** of an element $a \in G$ - smallest integer $k \ge 1$ such that $a^k = a \cdot a \cdot ... \cdot a = 1$
- **cyclic group** - group $G$ with an element $a$ with ord($a$) = $|G|$
    - **generator/primitive element** - $a$

- for every prime p, $\mathbb{Z}_{p}^{\times}$ is cyclic

### order of elements

for every $a \in G$

1. $a^{|G|} = 1$
2. ord($a$) divides $|G|$


#### for finite cyclic groups

1. number of primitive elements of G is $\phi(|G|)$ 
2. if $|G|$ is prime, all elements other than 1 in $G$ are primitive

## subgroups

subset of a group that is also a group

Let $G$ be a cyclic group of order $n$ with generator $\alpha$. Then

- For every integer $k$ that divides $n$ there is exactly one cyclic subgroup $H \leq G$ of order $k$
- The subgroup $H$ is generated by ${\alpha}^{\frac{n}{k}}$
- There are exactly $k$ element $a \in G$ that satisfy $a^k = 1$

### lagrange's theorem

for every subgroup H of a group G, |H| divides |G|

## discrete logarithm problem (DLP)

### DLP in $\mathbb{Z}_{p}^{\times}$

let $\alpha \in \mathbb{Z}_{p}^{\times}$ be a generator. given and $\beta \in \mathbb{Z}_{p}^{\times}$, the DLP is the problem of finding an integer $1 \leq x \leq p-1$ such that ${\alpha}^x = \beta mod p$

- x is the "discrete logarithm of $\beta$ to the base $\alpha$  ($x = \text{log }_{\alpha} \beta \text{ mod } p$)

### DLP for any cyclic group

let G be a cyclic group of order $n$ and let $\alpha \in G$ be a generator. given any $\beta \in G$, the DLP is the problem of finding an integer $1\leq x\leq n$ such that ${\alpha}^x =\beta$

- ${\alpha}^x$ repeats the binary operation of the group

## attacks on DLP

- Generic algorithms
    - Brute-Force Search
    - Shanks’ Baby-Step Giant-Step Method
    - Pollard’s Rho Method
    - Pohlig-Hellman Algorithm
- Nongeneric algorithms
    - The Index-Calculus Method


## elgamal encryption scheme  

![elgamal](./media/4cr3_elgamal.JPG)

### attacks

passive

- find bob's secret key by solving DLP: $b=\text{log }_{alpha} k_B \text{ mod } p$
- compute the shared key using alice's $k_A$: $K_{AB} = k_A^b \text{ mod } p$
- recover the message: $x = y \cdot k_{AB}^{-1} \text{ mod } p$


active

secret exponent should not be reused

1. Alice reuses the exponent a, then there are two ciphertexts (y1, kA), (y2, kA) over thechannel.
2. If Trudy knows the first message x1, he can compute $k_{AB} = y_1 x_1^{−1}$ mod p

elgamal is malleable

1. Trudy can replace (kA, y) with (kA, sy).
2. Bob decrypts $sy \cdot k_{AB}^{-1} = s \cdot (x \cdot k_{AB} ) \cdot k_{AB}^{-1} = sx \text{ mod } p$